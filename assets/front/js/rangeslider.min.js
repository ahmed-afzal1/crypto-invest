(function($) {
	
  "use strict";

const settings={
    fill: '#1f71d4',
    background: '#1f71d420'
  }
  
  const sliders = document.querySelectorAll('.price-range-area');

  Array.prototype.forEach.call(sliders,(slider)=>{

    slider.querySelector('input').addEventListener('input', (event)=>{

      var dbl = event.target.parentNode.parentNode.parentNode.querySelector('.dbl').value;
      event.target.parentNode.parentNode.parentNode.querySelector('.ck').innerHTML = event.target.value;
      var total = dbl * event.target.value;
      if(total % 1 != 0)
      {
        total = total.toFixed(2);
      }
      event.target.parentNode.parentNode.parentNode.querySelector('.dk').innerHTML = total;
      event.target.parentNode.parentNode.parentNode.querySelector('.payprice').value = event.target.value;

      event.target.parentNode.parentNode.parentNode.querySelector('.getprice').value = total;
      applyFill(event.target);
    });

    applyFill(slider.querySelector('input'));
  });

  function applyFill(slider) {

    const percentage = 100*(slider.value-slider.min)/(slider.max-slider.min);

    const bg = `linear-gradient(90deg, ${settings.fill} ${percentage}%, ${settings.background} ${percentage+0.1}%)`;
    slider.style.background = bg;
  }
  

  $(document).ready(function(){

    $('.payprice').on('change',function(){
      val1 = $(this).val();
      minPrice = $(this).parent().parent().find('.invest-min-price').val();
      maxPrice = $(this).parent().parent().find('.invest-max-price').val();
      maxPrice = parseInt(maxPrice);
      val1 = parseInt(val1);
      minPrice = parseInt(minPrice);
      if(val1 >= minPrice && val1 <= maxPrice) {
        val2 = $(this).parent().parent().find('.dbl').val();
        val2 = parseInt(val2);
        var total = val1 * val2;
        if(total % 1 != 0)
        {
          total = total.toFixed(2);
        }
  
        $(this).parent().parent().find('.dk').html(total);
        $(this).parent().parent().find('.getprice').val(total);
      }

    });

    $('.payprice').on('keyup',function(){
      val1 = $(this).val();
      minPrice = $(this).parent().parent().find('.invest-min-price').val();
      maxPrice = $(this).parent().parent().find('.invest-max-price').val();
      maxPrice = parseInt(maxPrice);
      val1 = parseInt(val1);
      minPrice = parseInt(minPrice);
      if(val1 >= minPrice && val1 <= maxPrice) {
        val2 = $(this).parent().parent().find('.dbl').val();
        val2 = parseInt(val2);
        var total = val1 * val2;
        if(total % 1 != 0)
        {
          total = total.toFixed(2);
        }
  
        $(this).parent().parent().find('.dk').html(total);
        $(this).parent().parent().find('.getprice').val(total);
      }
    });

  });
})(jQuery);